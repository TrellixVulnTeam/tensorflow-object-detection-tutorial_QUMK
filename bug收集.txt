5月29日

(tensorflow) C:\Users\yjz\Desktop\Tensorflow\models\research>python object_detection/builders/model_builder_tf2_test.py
2022-05-29 14:01:02.706652: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cudart64_110.dll'; dlerror: cudart64_110.dll not found
2022-05-29 14:01:02.707571: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
Traceback (most recent call last):
  File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\builders\model_builder_tf2_test.py", line 24, in <module>
    from object_detection.builders import model_builder
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\object_detection\builders\model_builder.py", line 23, in <module>
    from object_detection.builders import anchor_generator_builder
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\object_detection\builders\anchor_generator_builder.py", line 26, in <module>
    from object_detection.protos import anchor_generator_pb2
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\object_detection\protos\anchor_generator_pb2.py", line 5, in <module>
    from google.protobuf.internal import builder as _builder
ImportError: cannot import name 'builder' from 'google.protobuf.internal' (C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\google\protobuf\internal\__init__.py)
对protobuf进行降级，降级到3.20

(tensorflow) C:\Users\yjz\Desktop\Tensorflow\models\research>python object_detection/builders/model_builder_tf2_test.py
2022-05-29 14:06:06.331315: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cudart64_110.dll'; dlerror: cudart64_110.dll not found
2022-05-29 14:06:06.331438: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
Traceback (most recent call last):
  File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\builders\model_builder_tf2_test.py", line 21, in <module>
    import tensorflow.compat.v1 as tf
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\__init__.py", line 37, in <module>
    from tensorflow.python.tools import module_util as _module_util
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\python\__init__.py", line 37, in <module>
    from tensorflow.python.eager import context
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\python\eager\context.py", line 29, in <module>
    from tensorflow.core.framework import function_pb2
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\core\framework\function_pb2.py", line 16, in <module>
    from tensorflow.core.framework import attr_value_pb2 as tensorflow_dot_core_dot_framework_dot_attr__value__pb2
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\core\framework\attr_value_pb2.py", line 16, in <module>
    from tensorflow.core.framework import tensor_pb2 as tensorflow_dot_core_dot_framework_dot_tensor__pb2
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\core\framework\tensor_pb2.py", line 16, in <module>
    from tensorflow.core.framework import resource_handle_pb2 as tensorflow_dot_core_dot_framework_dot_resource__handle__pb2
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\core\framework\resource_handle_pb2.py", line 16, in <module>
    from tensorflow.core.framework import tensor_shape_pb2 as tensorflow_dot_core_dot_framework_dot_tensor__shape__pb2
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\core\framework\tensor_shape_pb2.py", line 18, in <module>
    DESCRIPTOR = _descriptor.FileDescriptor(
TypeError: __init__() got an unexpected keyword argument 'serialized_options'
对tensorflow进行降级，降级到2.5.0

(tensorflow) C:\Users\yjz\Desktop\Tensorflow\models\research>python object_detection/builders/model_builder_tf2_test.py
2022-05-29 14:27:30.774364: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cudart64_110.dll'; dlerror: cudart64_110.dll not found
2022-05-29 14:27:30.774449: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
Traceback (most recent call last):
  File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\builders\model_builder_tf2_test.py", line 24, in <module>
    from object_detection.builders import model_builder
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\object_detection\builders\model_builder.py", line 37, in <module>
    from object_detection.meta_architectures import deepmac_meta_arch
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\object_detection\meta_architectures\deepmac_meta_arch.py", line 20, in <module>
    from object_detection.models.keras_models import resnet_v1
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\object_detection\models\keras_models\resnet_v1.py", line 28, in <module>
    from keras.applications import resnet  # pylint:disable=g-import-not-at-top
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\__init__.py", line 24, in <module>
    from keras import models
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\models\__init__.py", line 18, in <module>
    from keras.engine.functional import Functional
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\functional.py", line 23, in <module>
    from keras import backend
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\backend.py", line 301, in <module>
    tf.__internal__.register_clear_session_function(clear_session)
AttributeError: module 'tensorflow.compat.v2.__internal__' has no attribute 'register_clear_session_function'


---


models-python-tensorflow-keras都要保持最新，因为使用到的research是最新的，旧版本无法下载到。从此处开始，所有东西最新

 ---

(tensorflow) C:\Users\yjz\Desktop\Tensorflow\models\research>python object_detection/builders/model_builder_tf2_test.py
2022-05-29 16:21:51.413588: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cudart64_110.dll'; dlerror: cudart64_110.dll not found
2022-05-29 16:21:51.413740: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
Traceback (most recent call last):
  File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\builders\model_builder_tf2_test.py", line 24, in <module>
    from object_detection.builders import model_builder
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\object_detection\builders\model_builder.py", line 23, in <module>
    from object_detection.builders import anchor_generator_builder
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\object_detection\builders\anchor_generator_builder.py", line 26, in <module>
    from object_detection.protos import anchor_generator_pb2
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\object_detection\protos\anchor_generator_pb2.py", line 5, in <module>
    from google.protobuf.internal import builder as _builder
ImportError: cannot import name 'builder' from 'google.protobuf.internal' (C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\google\protobuf\internal\__init__.py)
已解决。关键在于配置好protobuf。

(tensorflow) C:\Users\yjz\Desktop\Tensorflow\workspace\training_demo>python model_main_tf2.py --model_dir=models/my_ssd_resnet50_v1_fpn --pipeline_config_path=models/my_ssd_resnet50_v1_fpn/pipeline.config
2022-05-30 11:16:51.741848: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-05-30 11:16:52.680930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 2149 MB memory:  -> device: 0, name: NVIDIA GeForce GTX 1650 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
I0530 11:16:52.811667  8440 mirrored_strategy.py:374] Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
INFO:tensorflow:Maybe overwriting train_steps: None
I0530 11:16:52.811667  8440 config_util.py:552] Maybe overwriting train_steps: None
INFO:tensorflow:Maybe overwriting use_bfloat16: False
I0530 11:16:52.811667  8440 config_util.py:552] Maybe overwriting use_bfloat16: False
WARNING:tensorflow:From C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\model_lib_v2.py:563: StrategyBase.experimental_distribute_datasets_from_function (from tensorflow.python.distribute.distribute_lib) is deprecated and will be removed in a future version.
Instructions for updating:
rename to distribute_datasets_from_function
W0530 11:16:52.842909  8440 deprecation.py:350] From C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\model_lib_v2.py:563: StrategyBase.experimental_distribute_datasets_from_function (from tensorflow.python.distribute.distribute_lib) is deprecated and will be removed in a future version.
Instructions for updating:
rename to distribute_datasets_from_function
INFO:tensorflow:Reading unweighted datasets: ['annotations/train.record']
I0530 11:16:52.842909  8440 dataset_builder.py:162] Reading unweighted datasets: ['annotations/train.record']
INFO:tensorflow:Reading record datasets for input file: ['annotations/train.record']
I0530 11:16:52.842909  8440 dataset_builder.py:79] Reading record datasets for input file: ['annotations/train.record']
INFO:tensorflow:Number of filenames to read: 1
I0530 11:16:52.842909  8440 dataset_builder.py:80] Number of filenames to read: 1
WARNING:tensorflow:num_readers has been reduced to 1 to match input file shards.
W0530 11:16:52.842909  8440 dataset_builder.py:86] num_readers has been reduced to 1 to match input file shards.
WARNING:tensorflow:From C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\builders\dataset_builder.py:100: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.deterministic`.
W0530 11:16:52.858530  8440 deprecation.py:350] From C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\builders\dataset_builder.py:100: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.deterministic`.
WARNING:tensorflow:From C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\builders\dataset_builder.py:235: DatasetV1.map_with_legacy_function (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.map()
W0530 11:16:52.905398  8440 deprecation.py:350] From C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\builders\dataset_builder.py:235: DatasetV1.map_with_legacy_function (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.map()
WARNING:tensorflow:From C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\python\util\dispatch.py:1082: sparse_to_dense (from tensorflow.python.ops.sparse_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Create a `tf.sparse.SparseTensor` and use `tf.sparse.to_dense` instead.
W0530 11:16:59.194138  8440 deprecation.py:350] From C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\python\util\dispatch.py:1082: sparse_to_dense (from tensorflow.python.ops.sparse_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Create a `tf.sparse.SparseTensor` and use `tf.sparse.to_dense` instead.
WARNING:tensorflow:From C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\python\util\dispatch.py:1082: sample_distorted_bounding_box (from tensorflow.python.ops.image_ops_impl) is deprecated and will be removed in a future version.
Instructions for updating:
`seed2` arg is deprecated.Use sample_distorted_bounding_box_v2 instead.
W0530 11:17:02.075331  8440 deprecation.py:350] From C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\python\util\dispatch.py:1082: sample_distorted_bounding_box (from tensorflow.python.ops.image_ops_impl) is deprecated and will be removed in a future version.
Instructions for updating:
`seed2` arg is deprecated.Use sample_distorted_bounding_box_v2 instead.
WARNING:tensorflow:From C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\python\util\dispatch.py:1082: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0530 11:17:04.169520  8440 deprecation.py:350] From C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\python\util\dispatch.py:1082: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\backend.py:450: UserWarning: `tf.keras.backend.set_learning_phase` is deprecated and will be removed after 2020-10-11. To update it, simply pass a True/False value to the `training` argument of the `__call__` method of your layer or model.
  warnings.warn('`tf.keras.backend.set_learning_phase` is deprecated and '
2022-05-30 11:17:30.191355: I tensorflow/stream_executor/cuda/cuda_dnn.cc:384] Loaded cuDNN version 8400
Could not locate zlibwapi.dll. Please make sure it is in your library path!
尝试下载它，链接是https://docs.nvidia.com/deeplearning/cudnn/install-guide/index.html#installcuda-windows
将zlibwapi.dll放在System32中，然后在系统环境变量添加.dll文件。为保险起见，复制该文件到训练文件夹（training_demo）中



2022-05-30 12:13:29.096553: W tensorflow/core/common_runtime/bfc_allocator.cc:491] ****************************************************************************************************
2022-05-30 12:13:29.096584: W tensorflow/core/framework/op_kernel.cc:1733] RESOURCE_EXHAUSTED: failed to allocate memory
Traceback (most recent call last):
  File "C:\Users\yjz\Desktop\Tensorflow\workspace\training_demo\model_main_tf2.py", line 114, in <module>
    tf.compat.v1.app.run()
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\python\platform\app.py", line 36, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\absl\app.py", line 312, in run
    _run_main(main, args)
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\absl\app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "C:\Users\yjz\Desktop\Tensorflow\workspace\training_demo\model_main_tf2.py", line 105, in main
    model_lib_v2.train_loop(
  File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\model_lib_v2.py", line 685, in train_loop
    losses_dict = _dist_train_step(train_input_iter)
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\python\util\traceback_utils.py", line 153, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\tensorflow\python\eager\execute.py", line 54, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.ResourceExhaustedError: Graph execution error:
先解决资源耗尽的问题，将batch_size调成4


Detected at node 'ResNet50V1_FPN/model/conv2_block2_3_bn/FusedBatchNormV3' defined at (most recent call last):
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\threading.py", line 930, in _bootstrap
      self._bootstrap_inner()
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\threading.py", line 973, in _bootstrap_inner
      self.run()
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\model_lib_v2.py", line 635, in train_step_fn
      losses_dict = eager_train_step(
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\model_lib_v2.py", line 309, in eager_train_step
      losses_dict, _ = _compute_losses_and_predictions_dicts(
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\model_lib_v2.py", line 124, in _compute_losses_and_predictions_dicts
      prediction_dict = model.predict(
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\meta_architectures\ssd_meta_arch.py", line 569, in predict
      if self._feature_extractor.is_keras_model:
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\meta_architectures\ssd_meta_arch.py", line 570, in predict
      feature_maps = self._feature_extractor(preprocessed_inputs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\training.py", line 490, in __call__
      return super().__call__(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\base_layer.py", line 1014, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\meta_architectures\ssd_meta_arch.py", line 251, in call
      return self._extract_features(inputs)
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\models\ssd_resnet_v1_fpn_keras_feature_extractor.py", line 223, in _extract_features
      image_features = self.classification_backbone(
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\training.py", line 490, in __call__
      return super().__call__(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\base_layer.py", line 1014, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\functional.py", line 458, in call
      return self._run_internal_graph(
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\functional.py", line 596, in _run_internal_graph
      outputs = node.layer(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\base_layer.py", line 1014, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\core\freezable_batch_norm.py", line 68, in call
      return super(FreezableBatchNorm, self).call(inputs, training=training)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\layers\normalization\batch_normalization.py", line 750, in call
      outputs = self._fused_batch_norm(inputs, training=training)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\layers\normalization\batch_normalization.py", line 594, in _fused_batch_norm
      output, mean, variance = control_flow_util.smart_cond(
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\control_flow_util.py", line 105, in smart_cond
      return tf.__internal__.smart_cond.smart_cond(
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\layers\normalization\batch_normalization.py", line 571, in _fused_batch_norm_training
      return tf.compat.v1.nn.fused_batch_norm(
Node: 'ResNet50V1_FPN/model/conv2_block2_3_bn/FusedBatchNormV3'
Detected at node 'ResNet50V1_FPN/model/conv2_block2_3_bn/FusedBatchNormV3' defined at (most recent call last):
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\threading.py", line 930, in _bootstrap
      self._bootstrap_inner()
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\threading.py", line 973, in _bootstrap_inner
      self.run()
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\model_lib_v2.py", line 635, in train_step_fn
      losses_dict = eager_train_step(
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\model_lib_v2.py", line 309, in eager_train_step
      losses_dict, _ = _compute_losses_and_predictions_dicts(
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\model_lib_v2.py", line 124, in _compute_losses_and_predictions_dicts
      prediction_dict = model.predict(
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\meta_architectures\ssd_meta_arch.py", line 569, in predict
      if self._feature_extractor.is_keras_model:
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\meta_architectures\ssd_meta_arch.py", line 570, in predict
      feature_maps = self._feature_extractor(preprocessed_inputs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\training.py", line 490, in __call__
      return super().__call__(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\base_layer.py", line 1014, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\meta_architectures\ssd_meta_arch.py", line 251, in call
      return self._extract_features(inputs)
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\models\ssd_resnet_v1_fpn_keras_feature_extractor.py", line 223, in _extract_features
      image_features = self.classification_backbone(
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\training.py", line 490, in __call__
      return super().__call__(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\base_layer.py", line 1014, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\functional.py", line 458, in call
      return self._run_internal_graph(
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\functional.py", line 596, in _run_internal_graph
      outputs = node.layer(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 64, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\engine\base_layer.py", line 1014, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\traceback_utils.py", line 92, in error_handler
      return fn(*args, **kwargs)
    File "C:\Users\yjz\Desktop\Tensorflow\models\research\object_detection\core\freezable_batch_norm.py", line 68, in call
      return super(FreezableBatchNorm, self).call(inputs, training=training)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\layers\normalization\batch_normalization.py", line 750, in call
      outputs = self._fused_batch_norm(inputs, training=training)
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\layers\normalization\batch_normalization.py", line 594, in _fused_batch_norm
      output, mean, variance = control_flow_util.smart_cond(
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\utils\control_flow_util.py", line 105, in smart_cond
      return tf.__internal__.smart_cond.smart_cond(
    File "C:\Users\yjz\anaconda3\envs\tensorflow\lib\site-packages\keras\layers\normalization\batch_normalization.py", line 571, in _fused_batch_norm_training
      return tf.compat.v1.nn.fused_batch_norm(
Node: 'ResNet50V1_FPN/model/conv2_block2_3_bn/FusedBatchNormV3'
2 root error(s) found.
  (0) RESOURCE_EXHAUSTED:  OOM when allocating tensor with shape[8,256,160,160] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
         [[{{node ResNet50V1_FPN/model/conv2_block2_3_bn/FusedBatchNormV3}}]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info. This isn't available when running in Eager mode.

         [[Func/while/body/_1/train_input_images/write_summary/summary_cond/then/_3148/input/_3197/_28]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info. This isn't available when running in Eager mode.

  (1) RESOURCE_EXHAUSTED:  OOM when allocating tensor with shape[8,256,160,160] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
         [[{{node ResNet50V1_FPN/model/conv2_block2_3_bn/FusedBatchNormV3}}]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info. This isn't available when running in Eager mode.

0 successful operations.
0 derived errors ignored. [Op:__inference__dist_train_step_64534]